{% extends 'main/base.html' %}
{% load static %}
{% block content %}
<div class="product_map">
    <h1>{{ product.name }}</h1>

    {% if product.images.all %}
        <div class="image-gallery">
            {% for image in product.images.all %}
                <img src="{{ image.image.url }}" alt="{{ product.name }}" width="300">
            {% endfor %}
        </div>
    {% else %}
        <p>–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤—ñ–¥—Å—É—Ç–Ω—ñ.</p>
    {% endif %}

    <p><strong>–ê—Ä—Ç–∏–∫—É–ª:</strong> {{ product.code }}</p>
    <p><strong>–û–ø–∏—Å:</strong> {{ product.description }}</p>
    
    {% if product.sale_price %}
        <p><strong>–¶—ñ–Ω–∞:</strong> <del>{{ product.price }}</del> <span style="color: red;">{{ product.sale_price }}</span></p>
    {% else %}
        <p><strong>–¶—ñ–Ω–∞:</strong> {{ product.price }}</p>
    {% endif %}
    {% if product.availability == availability_choices.IN_AVAILABILITY %}
        <button class="btn btn-sm btn-primary add-to-cart" data-product-id="{{ product.id }}">üõí –î–æ–¥–∞—Ç–∏</button>
    {% else %}
        <p style="color: red; font-weight: bold;">–ù–µ–º–∞—î –≤ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ</p>
    {% endif %}

    <p><strong>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:</strong> 
        <a href="{% url 'category_detail' product.product_category.id %}">{{ product.product_category.name }}</a>
    </p>

    {% if product.vendor %}
        <p><strong>–ë—Ä–µ–Ω–¥:</strong> 
            <a href="{% url 'vendor_detail' product.vendor.id %}">{{ product.vendor.name }}</a>
        </p>
    {% endif %}

    {% if product.tags.all %}
        <p><strong>–¢–µ–≥–∏:</strong> 
            {% for tag in product.tags.all %}
                <span class="badge">{{ tag.name }}</span>
            {% endfor %}
        </p>
    {% endif %}

    {% if product.genre.all %}
        <p><strong>–ñ–∞–Ω—Ä–∏:</strong> 
            {% for genre in product.genre.all %}
                <span class="badge">{{ genre.name }}</span>
            {% endfor %}
        </p>
    {% endif %}
    <h3>–í—ñ–¥–≥—É–∫–∏</h3>
    {% for review in product.reviews.all %}
        <p><strong>{{ review.user.first_name }}</strong> ({{ review.get_mark_display }})</p>
        <p>{{ review.text }}</p>
        <hr>
    {% empty %}
        <p>–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –≤—ñ–¥–≥—É–∫—ñ–≤.</p>
    {% endfor %}
    
    {% if user.is_authenticated %}
        <a href="{% url 'add_review' product.id %}">‚ûï –î–æ–¥–∞—Ç–∏ –≤—ñ–¥–≥—É–∫</a>
    {% else %}
        <p>–©–æ–± –∑–∞–ª–∏—à–∏—Ç–∏ –≤—ñ–¥–≥—É–∫, <a href="{% url 'login' %}">—É–≤—ñ–π–¥—ñ—Ç—å</a>.</p>
    {% endif %}
    <a href="{% url 'product_menu_page' 'products' %}" class="btn btn-primary">–ù–∞–∑–∞–¥ –¥–æ —Å–ø–∏—Å–∫—É —Ç–æ–≤–∞—Ä—ñ–≤</a>
</div>
{% endblock %}
